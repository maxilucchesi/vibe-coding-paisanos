(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{25:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{callServer:function(){return s.callServer},createServerReference:function(){return i},findSourceMapURL:function(){return r.findSourceMapURL}});let s=a(4770),r=a(526),i=a(2207).createServerReference},7277:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var s=a(4727),r=a(8319),i=a(2822),n=a.n(i),o=a(184),l=a(2288),d=a(7211);let c=(0,d.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var m=a(1924),u=a(3126);let h=(0,d.A)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);var x=a(6290);let v=(0,d.A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var p=a(9173),g=a(7348),b=a(1375);function f(){let[e,t]=(0,r.useState)(0),[a,i]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=()=>{l(navigator.onLine),t((0,p.M7)().filter(e=>e.pending_sync).length)};e(),window.addEventListener("online",e),window.addEventListener("offline",e);let a=setInterval(e,3e4);return()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e),clearInterval(a)}},[]);let d=async()=>{if(!n){(0,b.o)({title:"Sin conexi\xf3n",description:"No hay conexi\xf3n a internet. Intenta m\xe1s tarde.",variant:"destructive"});return}if(0===e){(0,b.o)({title:"Todo sincronizado",description:"No hay cambios pendientes para sincronizar."});return}i(!0);try{let a=await (0,g.B)();a.success?((0,b.o)({title:"Sincronizaci\xf3n completada",description:"Se han sincronizado ".concat(e," libros.")}),t(0)):(0,b.o)({title:"Error de sincronizaci\xf3n",description:a.message,variant:"destructive"})}catch(e){console.error("Error al sincronizar:",e),(0,b.o)({title:"Error de sincronizaci\xf3n",description:"No se pudieron sincronizar los cambios. Intenta m\xe1s tarde.",variant:"destructive"})}finally{i(!1)}};return 0===e&&n?null:(0,s.jsx)("div",{className:"mb-4 p-2 rounded-lg ".concat(n?"bg-amber-50":"bg-red-50"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[n?(0,s.jsx)(h,{className:"h-4 w-4 text-amber-500 mr-1"}):(0,s.jsx)(x.A,{className:"h-4 w-4 text-red-500 mr-1"}),(0,s.jsx)("span",{className:"text-xs",children:n?e>0?"".concat(e," pendientes"):"Sincronizado":"Sin conexi\xf3n"})]}),n&&e>0&&(0,s.jsxs)(o.$,{size:"sm",variant:"outline",className:"h-6 text-xs py-0 px-2",onClick:d,disabled:a,children:[a&&(0,s.jsx)(v,{className:"h-3 w-3 mr-1 animate-spin"}),a?"...":"Sincronizar"]})]})})}let w=["\xbfY ahora qu\xe9 est\xe1s leyendo?","\xbfYa ten\xe9s tu pr\xf3ximo libro en la mira?","Dale, contame qu\xe9 est\xe1s leyendo.","Tu pr\xf3xima gran lectura empieza ac\xe1.","Tus libros quieren saber qu\xe9 pens\xe1s.","\xbfTerminaste? Contame c\xf3mo estuvo.","Cada libro que le\xe9s cuenta algo sobre vos.","Tu historia, contada en libros.","Esta app quiere ser parte de tu pr\xf3xima gran lectura.","Porque cada p\xe1gina vale la pena recordarla.","Tus libros favoritos viven ac\xe1.","Las historias que te marcan, siempre con vos.","\xbfQu\xe9 and\xe1s leyendo \xfaltimamente?","\xbfQu\xe9 tal estuvo ese libro?","\xbfLista para tu pr\xf3ximo cap\xedtulo?","\xbfAlgo nuevo para recomendar?","Contame qu\xe9 est\xe1s leyendo","Registr\xe1 tu \xfaltimo viaje literario","Tus libros esperan tu opini\xf3n","Guard\xe1 esa historia que no quer\xe9s olvidar","Tus lecturas, tus recuerdos","Tu biblioteca, tu historia","La app donde viven tus libros","Registr\xe1 lo que te mueve"];function j(){let e=Math.floor(Math.random()*w.length);return w[e]}let y=(0,d.A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);function N(e){let{onRefresh:t,children:a}=e,[i,n]=(0,r.useState)(!1),[o,l]=(0,r.useState)(0),[d,c]=(0,r.useState)(!1),m=(0,r.useRef)(null),u=(0,r.useRef)(0);return(0,r.useEffect)(()=>{let e=m.current;if(!e)return;let a=0,s=0,r=e=>{window.scrollY<=0&&(u.current=e.touches[0].clientY,n(!0))},o=e=>{if(!i)return;let t=Math.max(0,(s=e.touches[0].clientY)-u.current);l(Math.min(100,t/80*100)),t>10&&window.scrollY<=0&&e.preventDefault()},d=async()=>{if(i){if(Math.max(0,s-u.current)>=80){if("vibrate"in navigator)try{navigator.vibrate(50)}catch(e){console.log("Vibration not supported")}try{window.navigator&&window.navigator.haptics&&window.navigator.haptics.impact&&window.navigator.haptics.impact({style:"medium"})}catch(e){}c(!0);try{await t()}catch(e){console.error("Error refreshing:",e)}finally{c(!1)}}n(!1),l(0)}};return e.addEventListener("touchstart",r,{passive:!1}),e.addEventListener("touchmove",o,{passive:!1}),e.addEventListener("touchend",d),()=>{e.removeEventListener("touchstart",r),e.removeEventListener("touchmove",o),e.removeEventListener("touchend",d)}},[i,t]),(0,s.jsxs)("div",{ref:m,className:"relative min-h-full",children:[(0,s.jsx)("div",{className:"absolute left-0 right-0 flex justify-center transition-transform duration-200 z-10 ".concat(i||d?"opacity-100":"opacity-0"),style:{transform:"translateY(".concat(i?o/2:0,"px)"),top:"-40px"},children:(0,s.jsx)("div",{className:"bg-white rounded-full p-2 shadow-md",children:d?(0,s.jsx)("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-[#FFA69E] border-t-transparent"}):(0,s.jsx)(y,{className:"h-6 w-6 text-[#FFA69E] transition-transform duration-300 ".concat(o>80?"rotate-180":"")})})}),a]})}function E(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)([]),[d,h]=(0,r.useState)(!0),[x,v]=(0,r.useState)(!1),[p,g]=(0,r.useState)(Date.now()),[w,y]=(0,r.useState)(""),[E,S]=(0,r.useState)(!1),F=function(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=()=>{t(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}(),[M,L]=(0,r.useState)("gallery"),k=new Date,A=3===k.getMonth()&&23===k.getDate();(0,r.useEffect)(()=>{{let e=localStorage.getItem("giuli-view-mode");("list"===e||"gallery"===e)&&L(e)}},[]);let D=async()=>{try{h(!0);let e=await (0,m.ST)("read"),a=await (0,m.ST)("wishlist");t(e),i(a),console.log("Dashboard data loaded:",{readBooks:e,wishlistBooks:a})}catch(e){console.error("Error al cargar libros:",e),(0,b.o)({title:"Error",description:"No se pudieron cargar los libros. Intenta refrescar la p\xe1gina.",variant:"destructive"})}finally{h(!1)}},z=async()=>{v(!0),g(Date.now()),y(j()),await D(),v(!1)},q=e=>e.length%2!=0?[...e,{isEmpty:!0}]:e;(0,r.useEffect)(()=>{y(j()),D();let e=()=>{console.log("Books updated event detected, reloading data..."),D()};window.addEventListener("booksUpdated",e);let t=()=>{console.log("Route change detected, reloading data..."),D()};return window.addEventListener("popstate",t),()=>{window.removeEventListener("booksUpdated",e),window.removeEventListener("popstate",t)}},[p]);let _=new Date().toISOString();return console.log("Dashboard rendered at: ".concat(_)),(0,s.jsx)(N,{onRefresh:z,children:(0,s.jsx)("div",{className:"min-h-screen bg-[#FDFCFB] p-6",children:(0,s.jsxs)("div",{className:"mx-auto max-w-md",children:[(0,s.jsxs)("header",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"font-serif text-2xl font-normal text-[#222222] text-[2.4rem]",children:"Mis Lecturas"}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(u.p,{viewMode:M,onViewModeChange:e=>{L(e),localStorage.setItem("giuli-view-mode",e)}})})]}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[#888888]",children:w})]}),A&&(0,s.jsxs)("div",{className:"mb-6 p-3 bg-[#FFF0EE] rounded-lg border border-[#FFA69E] text-center",children:[(0,s.jsx)("p",{className:"text-[#222222] font-medium",children:"✨\uD83D\uDCDA \xa1Feliz D\xeda Internacional del Libro! \uD83D\uDCDA✨"}),(0,s.jsx)("p",{className:"text-sm text-[#888888] mt-1",children:"Hoy los libros est\xe1n de fiesta, \xbfcu\xe1l invitar\xe1s a tu estanter\xeda?"})]}),(0,s.jsx)(f,{}),(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"font-serif text-xl text-[#222222]",children:"Le\xeddos recientemente"}),(0,s.jsx)(n(),{href:"/books?filter=read",className:"text-sm text-[#888888] hover:text-[#FFA69E]",children:"Ver todos"})]}),d?"gallery"===M?(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:Array.from({length:4}).map((e,t)=>(0,s.jsxs)("div",{className:"rounded-xl bg-white shadow-sm animate-pulse",children:[(0,s.jsx)("div",{className:"aspect-[1/1.545] bg-gray-200 rounded-t-lg"}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("div",{className:"h-4 w-3/4 bg-gray-200 rounded mb-2"}),(0,s.jsx)("div",{className:"h-3 w-1/2 bg-gray-200 rounded"})]})]},t))}):(0,s.jsx)("div",{className:"space-y-4",children:Array.from({length:3}).map((e,t)=>(0,s.jsxs)("div",{className:"rounded-xl bg-white p-4 shadow-sm animate-pulse",children:[(0,s.jsx)("div",{className:"h-6 w-3/4 bg-gray-200 rounded mb-2 mx-auto"}),(0,s.jsx)("div",{className:"h-4 w-1/2 bg-gray-200 rounded mx-auto"})]},t))}):e.length>0?"gallery"===M?(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:q(e.slice(-6).reverse()).map((e,t)=>e.isEmpty?(0,s.jsx)("div",{className:"invisible"},"empty-".concat(t)):(0,s.jsx)(l.M,{book:e,type:"read",viewMode:M},e.id||e.local_id||Date.now()))}):(0,s.jsx)("div",{className:"space-y-4",children:e.slice(-6).reverse().map(e=>(0,s.jsx)(l.M,{book:e,type:"read",viewMode:M},e.id||e.local_id||Date.now()))}):(0,s.jsxs)("div",{className:"rounded-xl bg-white p-4 text-center shadow-sm",children:[(0,s.jsx)("p",{className:"text-[#888888]",children:"No hay libros a\xf1adidos a\xfan"}),(0,s.jsx)(n(),{href:"/add-book",className:"mt-2 inline-block text-sm text-[#FFA69E] hover:underline",children:"A\xf1ade tu primer libro"})]})]}),(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"font-serif text-xl text-[#222222]",children:"Wishlist"}),(0,s.jsx)(n(),{href:"/books?filter=wishlist",className:"text-sm text-[#888888] hover:text-[#FFA69E]",children:"Ver todos"})]}),d?"gallery"===M?(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:Array.from({length:4}).map((e,t)=>(0,s.jsxs)("div",{className:"rounded-xl bg-[#F5F5F5] shadow-sm animate-pulse",children:[(0,s.jsx)("div",{className:"aspect-[1/1.545] bg-gray-300 rounded-t-lg"}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("div",{className:"h-4 w-3/4 bg-gray-300 rounded mb-2"}),(0,s.jsx)("div",{className:"h-3 w-1/2 bg-gray-300 rounded"})]})]},t))}):(0,s.jsx)("div",{className:"space-y-4",children:Array.from({length:3}).map((e,t)=>(0,s.jsxs)("div",{className:"rounded-xl bg-[#F5F5F5] p-4 text-center shadow-sm animate-pulse",children:[(0,s.jsx)("div",{className:"h-6 w-3/4 bg-gray-300 rounded mb-2 mx-auto"}),(0,s.jsx)("div",{className:"h-4 w-1/2 bg-gray-300 rounded mx-auto"})]},t))}):a.length>0?"gallery"===M?(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:q(a.slice(-6).reverse()).map((e,t)=>e.isEmpty?(0,s.jsx)("div",{className:"invisible"},"empty-".concat(t)):(0,s.jsx)(l.M,{book:e,type:"wishlist",viewMode:M},e.id||e.local_id||Date.now()))}):(0,s.jsx)("div",{className:"space-y-4",children:a.slice(-6).reverse().map(e=>(0,s.jsx)(l.M,{book:e,type:"wishlist",viewMode:M},e.id||e.local_id||Date.now()))}):(0,s.jsxs)("div",{className:"rounded-xl bg-[#F5F5F5] p-4 text-center shadow-sm",children:[(0,s.jsx)("p",{className:"text-[#888888]",children:"Tu wishlist est\xe1 vac\xeda"}),(0,s.jsx)(n(),{href:"/add-book?type=wishlist",className:"mt-2 inline-block text-sm text-[#FFA69E] hover:underline",children:"A\xf1ade libros a tu wishlist"})]})]}),(0,s.jsx)(n(),{href:"/add-book-with-search",children:(0,s.jsxs)("div",{className:"fixed bottom-6 right-6 group",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),children:[(0,s.jsxs)(o.$,{className:"h-14 w-14 rounded-full bg-[#FFA69E] p-0 shadow-lg hover:bg-[#D0E2FF] transition-all duration-300 ".concat(E?"scale-110":""),style:{boxShadow:"0 4px 14px rgba(255, 166, 158, 0.5)"},children:[(0,s.jsx)(c,{className:"h-7 w-7 text-white transition-all duration-300 ".concat(E?"rotate-90":""),strokeWidth:2.5}),(0,s.jsx)("span",{className:"sr-only",children:"A\xf1adir libro"})]}),F&&E&&(0,s.jsx)("span",{className:"absolute -top-10 right-0 bg-white px-3 py-1 rounded-full text-sm shadow-md animate-fade-in",children:"A\xf1adir libro con b\xfasqueda"})]})})]})})})}},7348:(e,t,a)=>{"use strict";a.d(t,{B:()=>r});var s=a(25);let r=(0,s.createServerReference)("00478ff53a27e04f76aa952f3b5e32f32d3de84303",s.callServer,void 0,s.findSourceMapURL,"syncPendingBooksAction")},7521:(e,t,a)=>{Promise.resolve().then(a.bind(a,7277))}},e=>{var t=t=>e(e.s=t);e.O(0,[228,520,569,22,865,898,246,266,79,296,358],()=>t(7521)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[388],{64:(e,r,t)=>{Promise.resolve().then(t.bind(t,2297))},2297:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{AddBookForm:()=>AddBookForm});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4727),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8319),next_link__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2822),next_link__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(next_link__WEBPACK_IMPORTED_MODULE_2__),next_navigation__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1435),_components_ui_button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(184),_components_ui_input__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7972),_components_ui_textarea__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(554),_components_ui_label__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(3474),_components_ui_radio_group__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(8315),_components_star_rating__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(1507),_barrel_optimize_names_ArrowLeft_lucide_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(6896),_components_ui_use_toast__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1375),_app_actions__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(3101),_lib_simple_auth__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(6593),_components_connection_status__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(4854);let getCurrentDate=()=>new Date().toISOString().split("T")[0];function AddBookForm(){let[isSubmitting,setIsSubmitting]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[bookType,setBookType]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)("read"),[rating,setRating]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[error,setError]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),[success,setSuccess]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),router=(0,next_navigation__WEBPACK_IMPORTED_MODULE_3__.useRouter)(),[formData,setFormData]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({title:"",author:"",date_finished:getCurrentDate(),review:""}),handleChange=e=>{let{id:r,value:t}=e.target;setFormData(e=>({...e,[r]:t}))},handleSubmit=async e=>{e.preventDefault(),setIsSubmitting(!0),setError(null),setSuccess(null);try{if(!(0,_lib_simple_auth__WEBPACK_IMPORTED_MODULE_11__.wR)())throw Error("Debes iniciar sesi\xf3n para guardar un libro");if(!formData.title.trim())throw Error("El t\xedtulo del libro es obligatorio");if(!formData.author.trim())throw Error("El autor del libro es obligatorio");let bookData={title:formData.title.trim(),author:formData.author.trim(),type:bookType,..."read"===bookType&&{rating:rating>0?rating:null,date_finished:formData.date_finished||null,review:formData.review.trim()||null}};console.log("Enviando datos del libro:",bookData),(0,_components_ui_use_toast__WEBPACK_IMPORTED_MODULE_10__.o)({title:"Guardando libro...",description:"Tu libro est\xe1 siendo guardado."});let result=await (0,_app_actions__WEBPACK_IMPORTED_MODULE_13__.Q)(bookData);if(console.log("Resultado de createBookAction:",result),result.success){if(result.clientSideCode)try{eval(result.clientSideCode)}catch(localStorageError){console.error("Error al guardar en localStorage desde el cliente:",localStorageError)}setSuccess(result.message),(0,_components_ui_use_toast__WEBPACK_IMPORTED_MODULE_10__.o)({title:"\xa1Libro guardado!",description:result.message}),setFormData({title:"",author:"",date_finished:getCurrentDate(),review:""}),setRating(0),setTimeout(()=>{router.push("/dashboard"),router.refresh()},1500)}else throw Error(result.message||"Error al guardar el libro")}catch(error){console.error("Error saving book:",error);let errorMessage=error instanceof Error?error.message:"Hubo un problema al guardar tu libro. Por favor, int\xe9ntalo de nuevo.";setError(errorMessage),(0,_components_ui_use_toast__WEBPACK_IMPORTED_MODULE_10__.o)({title:"Error",description:errorMessage,variant:"destructive"})}finally{setIsSubmitting(!1)}};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"min-h-screen bg-[#FDFCFB] p-6",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"mx-auto max-w-md",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("header",{className:"mb-8 flex items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_link__WEBPACK_IMPORTED_MODULE_2___default(),{href:"/dashboard",className:"mr-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_ArrowLeft_lucide_react__WEBPACK_IMPORTED_MODULE_14__.A,{className:"h-5 w-5 text-[#888888]"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h1",{className:"font-serif text-2xl font-normal text-[#222222]",children:"A\xf1adir un libro"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_connection_status__WEBPACK_IMPORTED_MODULE_12__.v,{}),error&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mb-6 rounded-lg bg-red-500 p-4 text-white",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:error})}),success&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mb-6 rounded-lg bg-green-500 p-4 text-white",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:success})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("form",{className:"space-y-8",onSubmit:handleSubmit,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_radio_group__WEBPACK_IMPORTED_MODULE_8__.z,{defaultValue:"read",className:"mb-6 flex rounded-full bg-[#F5F5F5] p-1",onValueChange:setBookType,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"w-1/2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_radio_group__WEBPACK_IMPORTED_MODULE_8__.C,{value:"read",id:"read",className:"peer sr-only"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_label__WEBPACK_IMPORTED_MODULE_7__.J,{htmlFor:"read",className:"flex cursor-pointer justify-center rounded-full py-2 text-center text-sm peer-data-[state=checked]:bg-[#D0E2FF] peer-data-[state=checked]:text-[#222222] text-[#888888] transition-all duration-200",children:"Le\xeddo"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"w-1/2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_radio_group__WEBPACK_IMPORTED_MODULE_8__.C,{value:"wishlist",id:"wishlist",className:"peer sr-only"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_label__WEBPACK_IMPORTED_MODULE_7__.J,{htmlFor:"wishlist",className:"flex cursor-pointer justify-center rounded-full py-2 text-center text-sm peer-data-[state=checked]:bg-[#D0E2FF] peer-data-[state=checked]:text-[#222222] text-[#888888] transition-all duration-200",children:"Wishlist"})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-6",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_label__WEBPACK_IMPORTED_MODULE_7__.J,{htmlFor:"title",className:"text-sm text-[#888888]",children:"T\xedtulo del libro"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_input__WEBPACK_IMPORTED_MODULE_5__.p,{id:"title",value:formData.title,onChange:handleChange,className:"rounded-lg border-[#D0E2FF] bg-white px-4 py-2 text-[#222222] placeholder:text-[#CCCCCC] focus:border-[#FFA69E] focus:ring-[#FFA69E]",placeholder:"Ingresa el t\xedtulo del libro",required:!0})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_label__WEBPACK_IMPORTED_MODULE_7__.J,{htmlFor:"author",className:"text-sm text-[#888888]",children:"Autor"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_input__WEBPACK_IMPORTED_MODULE_5__.p,{id:"author",value:formData.author,onChange:handleChange,className:"rounded-lg border-[#D0E2FF] bg-white px-4 py-2 text-[#222222] placeholder:text-[#CCCCCC] focus:border-[#FFA69E] focus:ring-[#FFA69E]",placeholder:"Ingresa el nombre del autor",required:!0})]}),"read"===bookType&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_label__WEBPACK_IMPORTED_MODULE_7__.J,{htmlFor:"date_finished",className:"text-sm text-[#888888]",children:"Fecha de finalizaci\xf3n"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_input__WEBPACK_IMPORTED_MODULE_5__.p,{id:"date_finished",type:"date",value:formData.date_finished,onChange:handleChange,className:"rounded-lg border-[#D0E2FF] bg-white px-4 py-2 text-[#222222] focus:border-[#FFA69E] focus:ring-[#FFA69E]"})]}),"read"===bookType&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_label__WEBPACK_IMPORTED_MODULE_7__.J,{className:"text-sm text-[#888888]",children:"Valoraci\xf3n"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_star_rating__WEBPACK_IMPORTED_MODULE_9__.G,{rating:rating,setRating:setRating})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_label__WEBPACK_IMPORTED_MODULE_7__.J,{htmlFor:"review",className:"text-sm text-[#888888]",children:"Tus pensamientos"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_textarea__WEBPACK_IMPORTED_MODULE_6__.T,{id:"review",value:formData.review,onChange:handleChange,className:"min-h-[100px] rounded-lg border-[#D0E2FF] bg-white px-4 py-2 text-[#222222] placeholder:text-[#CCCCCC] focus:border-[#FFA69E] focus:ring-[#FFA69E]",placeholder:"Escribe tus pensamientos sobre este libro..."})]})]})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_button__WEBPACK_IMPORTED_MODULE_4__.$,{type:"submit",className:"h-12 w-full rounded-full bg-[#D0E2FF] text-[#222222] hover:bg-[#FFA69E] transition-all duration-300",disabled:isSubmitting,children:isSubmitting?"Guardando...":"Guardar libro"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_link__WEBPACK_IMPORTED_MODULE_2___default(),{href:"/dashboard",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_button__WEBPACK_IMPORTED_MODULE_4__.$,{type:"button",variant:"outline",className:"h-12 w-full rounded-full border-[#888888] text-[#888888] hover:bg-[#F5F5F5] transition-all duration-300",children:"Cancelar"})})]})]})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[228,520,317,735,79,296,358],()=>r(64)),_N_E=e.O()}]);